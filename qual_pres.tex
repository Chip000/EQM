\documentclass{beamer}

\mode<presentation>
{
%  \usetheme{Berkeley}
  \usetheme{Warsaw}
  \setbeamercovered{transparent}
}

\usepackage[brazil]{babel}
\usepackage[latin1]{inputenc}

\usepackage{graphicx}
\usepackage{setspace}
\usepackage{graphics}
\usepackage[portugues, 
	    resetcount, 
	    noline]{algorithm2e}
\usepackage{amsmath}
\usepackage{amsfonts}

\include{include/abaco}

\title[PLI e PR para Problemas de Rearranjo de Genomas]{Programação
  Linear Inteira e Programação Lógica por Restrições para Problemas de
  Rearranjo de Genomas} 

\author{Victor de Abreu Iizuka}

\institute[Universidade Estadual de Campinas] {
  \text{Orientador: Zanoni Dias} \\
  \textbf{Instituto de Computação - UNICAMP}\\
  \parbox{1in}{\center{\ABACO{2}{0}{0}{9}{0.7}}}
}

\date{}

\begin{document}

\frame{\titlepage}

\frame{\tableofcontents}

\section{Introdução}

\frame{ 
  \frametitle{Introdução} 
  \begin{itemize}
  \item{Rearranjo de genomas é uma área que vem recebendo crescente
      atenção de pesquisadores no decorrer da última década.}
  \item{Rearranjos são eventos que melhor caracterizam a distância
      evolutiva entre duas éspécies do que o estudo de mutações
      pontuais.}
  \item{No modelo de rearranjo de genomas, um genoma é representado
      por uma seqüência de números inteiros, onde cada inteiro
      representa um gene ou um grupo de genes.}
  \end{itemize}
}

\frame{ 
  \frametitle{Introdução} 
  \begin{itemize}
  \item{A comparação de seqüências é o método mais usual de se
      caracterizar a ocorrência de mutações pontuais, sendo um dos
      problemas mais abordados em Biologia Computacional.}
  \item{O interesse em fazer tal comparação é encontrar a distância de
      edição, que é o número mínimo de operações de inserção, remoção
      e substituição necessárias que transformam uma seqüência em
      outra.}
  \item{A distância de edição é uma medida capaz de estimar a
      distância evolutiva entre duas cadeias, mas não possui a
      informação de quais operações globais foram utilizadas para a
      transformação de uma seqüência em outra.}
  \end{itemize}
}

\frame{ 
  \frametitle{Introdução} 
  \begin{itemize}
  \item{Estas operações globais são os chamados Rearranjos de Genomas,
      que podem ser, por exemplo, Reversões, Transposições, Fissões e
      Fusões.}
  \end{itemize}
  \begin{beamerboxesrounded}[center,shadow=true]{Definição:}
    Para fins computacionais, um genoma é representado por uma
    $n$-tupla de genes, quando não há genes repetidos essa $n$-tupla é
    chamanda de permutação. Uma permutação é representada como $\pi =
    (\pi_{1}~\pi_{2}~ \ldots~\pi_{n})$, onde $\pi_{i}$, para todo $ 1
    \le i \le n$, representa um gene (ou um grupo de genes) e os
    vários eventos de rearranjo $\rho$ são aplicados a $\pi$ de uma
    maneira específica.
  \end{beamerboxesrounded}  
}

\section{Ordenação por Reversões}

\frame{
  \frametitle{Ordenação por Reversões}
  \begin{beamerboxesrounded}[center,shadow=true]{Evento de Reversão:}
    O evento de reversão ocorre quando um bloco do genoma é
    invertido. Seja $\rho(i,j)$ uma reversão de um intervalo [i,j] e
    $\pi = (\pi_{1}~\pi_{2}~ \ldots~\pi_{n})$ uma permutação, no caso
    em que a permutação é orientada a reversão $\rho$ aplicada a
    permutação $\pi$ é escrita como:
    \begin{align}
      \pi \cdot \rho = (&\pi_{1}, \pi_{2}, ..., \pi_{i-1}, -\pi_{j}, -\pi_{j
        - 1}, ..., -\pi_{i + 1}, -\pi_{i}, 
      \pi_{j + 1}, ..., \pi_{n}) \nonumber
    \end{align}
    No caso em que a permutação não é orientada a reversão $\rho$ aplicada
    a permutação $\pi$ é escrita como:
    \begin{align}
      \pi \cdot \rho = (&\pi_{1}, \pi_{2}, ..., \pi_{i-1}, \pi_{j}, \pi_{j
        - 1}, ..., \pi_{i + 1}, \pi_{i}, 
      \pi_{j + 1}, ..., \pi_{n}) \nonumber
    \end{align}
  \end{beamerboxesrounded}  
}

\frame{
  \frametitle{Ordenação por Reversões}
  \begin{itemize}
  \item{Um estudo inicial sobre o problema da distância de reversão
      foi apresentado por Bafna e Pevzner (1993) que apresentaram um
      algoritmo de aproximação com razão de 1.5 quando a orientação
      dos genes é conhecida e 1.75 caso contrário.}
  \item{Conhecer a orientação dos genes em um genoma é importante no
      problema de reversão, pois existem algoritmos polinomiais caso a
      orientação seja conhecida.}
  \item{Entretanto, se não se conhece a orientação dos genes o
      problema de encontrar a distância de reversão pertence a classe
      de problemas NP-Difícil, demonstrado em Caprara, Lancia e Ng
      (1997).}
  \end{itemize}
}

\frame{
  \frametitle{Ordenação por Reversões}
  \begin{itemize}
  \item{O primeiro algoritmo polinomial para o problema de reversão
      com orientação conhecida foi criado por Hannenhalli e Pevzner
      (1995) que fez uso de várias operações aplicadas a uma estrutura
      intermediária conhecida como grafo de \textit{breakpoint}.}
  \item{A estratégia usada por Hannenhalli e Pevzner foi simplificada
      por Bergeron (2001).}
  \item{Existe um algoritmo com complexidade sub-quadrática
      apresentado por Tannier e Sagot (2004).}
  \item{Bader Moret e Yan (2001) apresentaram um algoritmo linear
      quando apenas a distância é necessária.}
  \end{itemize}
}

\frame{
  \frametitle{Ordenação por Reversões}
  \begin{itemize}
  \item{Um resultado importante obtido por Meidanis, Walter e Dias
      (2000), mostrou que toda teoria sobre reversões desenvolvida
      para genomas lineares pode ser adaptada facilmente para genomas
      circulares, que são comuns em seres inferiores como vírus e
      bactérias.}
  \item{Quando a orientação dos genes não é conhecida existem
      algoritmos de aproximação que se seguiram ao de Bafna e Pevzner
      citado anteriormente como, por exemplo, o algoritmo implementado
      por Berman, Hannenhalli e Karpinski (2002) com razão de
      aproximação de 1.375.}
  \end{itemize}
}

\section{Ordenação por Transposições}

\frame{
  \frametitle{Ordenação por Transposições}
  \begin{beamerboxesrounded}[center,shadow=true]{Evento de Transposição:}
    O evento de transposição ocorre quando dois blocos adjacentes no
    genoma trocam de posição. Representando-se um genoma pela
    permutação $\pi = (\pi_{1} \pi_{2} \ldots{} \pi_{n})$ , uma
    transposição $\rho(i, j, k)$, onde $1 \le i < j < k \le n + 1$,
    faz com que um intervalo $[i, j - 1]$ de $\pi$ seja inserido entre
    $\pi_{k - 1}$ e $\pi_{k}$, de outra forma, a transposição $\rho(i,
    j, k)$ aplicada a permutação $\pi$ é escrita como:
    \begin{align}
      \pi \cdot \rho = (&\pi_{1}, \pi_{2}, \ldots, \pi_{i-1}, \pi_{j},
      \ldots, \pi_{k - 1}, \nonumber \\
      &\pi_{i}, \pi_{i + 1}, \ldots, \pi_{j - 2}, \pi_{j - 1},\pi_{k},
      \ldots, \pi_{n}). \nonumber
    \end{align}
  \end{beamerboxesrounded}  
}

\frame{
  \frametitle{Ordenação por Transposições}
  \begin{itemize}
  \item{O problema de encontrar a distância de transposição, que
      envolve encontrar o menor número de transposições necessárias
      para transformar um genoma em outro.}
  \item{Estudado por Bafna e Pevzner (1995), que apresentaram um
      algoritmo capaz de fornecer uma resposta aproximada na razão de
      1.5, além de derivar um importante limitante inferior para o
      problema.}
  \item{Talvez a maior contribuição do trabalho de Bafna e Pevzner
      resida nas heurísticas implementadas, que utilizaram o conceito
      de \textit{breakpoints} e uma ferramenta que chamou de grafo de
      cíclos orientados com arestas de cores alternadas, que fora
      bastante utilizada em trabalhos posteriores.}
  \end{itemize}
}

\frame{
  \frametitle{Ordenação por Transposições}
  \begin{itemize}
  \item{Não se conhece nenhuma prova de que o problema da
      distância de transposição pertence a classe dos problemas
      NP-Difícil, sendo que também não existem evidências da
      existência de um algoritmo polinomial, o que torna o estudo do
      problema interessante.}
  \item{Recentemente, Elias e Hartman (2006) propuseram um novo
      algoritmo de aproximação na razão de 1.375.}
  \item{Labarre (2006) apresentou novos limitantes, além de definir
      classes de permutações em que a distância de transposição pode
      ser calculada em tempo e espaço lineares.}
  \end{itemize}
}

\frame{
  \frametitle{Ordenação por Transposições}
  \begin{itemize}
  \item{Uma generalização do problema de transposição é a operação de
      troca de blocos, cuja solução pode auxiliar na resolução do
      problema da distância de transposição, já que a distância de
      troca de blocos entre dois genomas é um problema com solução
      polinomial para qualquer permutação.}
  \item{Christie (1996) apresentou um algoritmo polinomial para o
      problema de troca de blocos e utilizou, na implementação do
      algoritmo, conceitos já conhecidos na literatura sobre
      transposição.}
  \end{itemize}
}

\section{Ordenação por Reversões e Transposições}

\frame{
  \frametitle{Ordenação por Reversões e Transposições}
  \begin{itemize}
  \item{No que diz a respeito apenas aos eventos de reversão e
      transposição existe o trabalho de Hannenhalli e co-autores
      (1995), que analisaram a evolução de genomas por diferentes
      eventos, em especial reversões e transposições.}
  \item{Gu, Peng e Sudborough (1996) criaram um algoritmo de
      aproximação para computar a distância entre dois genomas com a
      orientação dos genes conhecida permitindo operações de reversão,
      transposição e reversão+transposição simultaneamente.}
  \end{itemize}
}

\frame{
  \frametitle{Ordenação por Reversões e Transposições}
  \begin{itemize}
  \item{Walter, Dias e Meidanis (1998) apresentaram um algoritmo de
      aproximação para a distância de reversão e transposição, além de
      limitantes para o diâmetro de reversão e transposição em
      permutações orientadas que foram posteriormente melhorados em
      Meidanis, Walter e Dias (2002).}
  \item{Dias e de Souza (2007) apresentaram uma modelagem com
      programação linear inteira para o problema de reversão,
      transposição ou reversão e transposição simultaneamente.}
  \end{itemize}
}

\section{Programação Linear Inteira}

\frame{
  \frametitle{Programação Linear Inteira}
  \begin{itemize}
  \item{Apresentado por Dias e de Souza (2007).}
  \item{Modelo para o problema da distância com tamanho polinomial.}
  \item{Modelo específico para os eventos de reversão, transposição ou
      reversão e transposição simultaneamente.}
  \item{Possui um tempo de execução muito grande. O programa retornava
      \textit{timeout} para instâncias de tamanho
      10 (tempo limite de 10 horas).}
  \item{Inviável na prática.}
  \end{itemize}
}

\scriptsize

\subsection{Modelo}

%%% Variaveis e restricoes comuns

\frame{
  \frametitle{Modelo}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Primeiramente vamos apresentar as variáveis e restrições que são
    comuns para todos modelos. A idéia é assegurar que só estamos
    tratando com permutações válidas.
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis $B_{ijk}$}
    Indicam se a $i$-ésima posição de $\pi$
    possui o valor $j$ depois da $k$-ésima operação ter sido executada,
    para todo $1 \le i, j \le n$ e todo $ 0 \le k < n$.
    \[
    B_{ijk} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\pi[i]$ = $j$ depois da $k$-ésima operação \\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Restrições Comuns}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As restrições \ref{eq:corr1} e \ref{eq:corr2} garantem que a
    permutação inicial e a final são corretas.
    \begin{equation}
      \label{eq:corr1}
      B_{i,\pi[i],0} = 1, \text{para todo $1 \le i \le n$}.
    \end{equation}
    \begin{equation}
      \label{eq:corr2}
      B_{i,\sigma[i],n-1} = 1, \text{para todo $1 \le i \le n$}.
    \end{equation}
    A restrição \ref{eq:posval} garante que cada posição de uma
    permutação possui exatamente um valor associado a ela. Já a
    restrição \ref{eq:valpos} garante que todo valor esteja associado
    a uma posição de cada permutação.
    \begin{equation}
      \label{eq:posval}
      \sum_{j=1}^{n} B_{ijk} = 1, \text{para todo $1 \le i \le n$, 
        $0 \le k < n$}.
    \end{equation}
    \begin{equation}
      \label{eq:valpos}
      \sum_{i=1}^{n} B_{ijk} = 1, \text{para todo $1 \le i \le n$, 
        $0 \le k < n$}.
    \end{equation}
  \end{beamerboxesrounded}
}

%%% Transposicoes

\frame{
  \frametitle{Modelo - Transposição}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Agora vamos apresentar as variáveis e restrições que são
    referentes à operação de transposição.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $t_{abck}$}
    Indicam quando a $k$-ésima operação de transposição realiza a
    troca de lugares dos blocos $\pi[a \cdots b - 1]$ e $\pi[b \cdots
    c - 1]$ de $\pi$, para todo $1 \le a < b < c \le n + 1$ e todo $ 1
    \le k < n$.
    \[
    t_{abck} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(a,b,c)$ \\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $t_{k}$}
    É usada para decidir se a $k$-ésima operação de transposição
    modificou a permutação, para todo $ 1 \le k < n$.
    \[
    t_{k} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(x,y,z)$ e $\rho_{k} \rho_{k-1} \cdots 
        \rho_{1} \pi \neq \rho_{k-1} \cdots \rho_{1} \pi$\\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Transposição - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As restrições \ref{eq:transp1} e \ref{eq:transp2} são necessárias
    para identificar as transposições que fazem parte da solução.
    \begin{align}
      &t_{k} \le t_{k-1}, \text{para todo $1 \le k <
        n$}. \label{eq:transp1} \\
      \sum_{a=1}^{n-1}\sum_{b=a+1}^{n}\sum_{c=b+1}^{n+1} &t_{abck} \le
      t_{k} , \text{para todo $1 \le k < n$}. \label{eq:transp2}
    \end{align}
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As próximas restrições refletem a modificações na permutação
    causada pela transposição a cada passo da execução. A análise será
    dividida em três casos onde, para cada caso, analisamos cada
    posição $i$ da permutação para verificar seu valor após a operação
    de transposição $\rho(a,b,c)$ ser completada.
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Transposição - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    1. $i < a$ ou $i \ge c$:
    \begin{align}
      \sum_{a=i+1}^{n-1}\sum_{b=a+1}^{n}\sum_{c=b+1}^{n+1} t_{abck} +
      \sum_{a=1}^{n-1}\sum_{b=a+1}^{n}\sum_{c=b+1}^{i} t_{abck} +
      (1 - t_{k}) + B_{i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{para todo $1 \le i, j \le n$ e todo $1 \le k < n$}.
      \label{eq:transp3}
    \end{align}
    2. $a \le i < a + c -b$:
    \begin{align}
      t_{abck} + B_{b-a+i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{$1 \le a < b < c \le n + 1, a \le i < a + c -b, 1 \le j
        \le n, 1 \le k < n$}.
      \label{eq:transp4}
    \end{align}
    3. $a + c - b \le i < c$:
    \begin{align}
      t_{abck} + B_{b-c+i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{$1 \le a < b < c \le n + 1, a + c - b \le i < c, 1 \le j
        \le n, 1 \le k < n$}.
      \label{eq:transp5}
    \end{align}
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Transposição - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Usando o limitante superior e o inferior definido por Bafna e
    Pevzner (1998), obtemos as seguintes restrições. \\
    \begin{align}
      t_{k} * n + k - 1 &\ge LB(\pi,\sigma), \text{para todo $1 \le k
        \le n$}. \label{eq:transp6} \\
      t_{k} * k &\le UB(\pi,\sigma), \text{para todo $1 \le k \le
        n$}. \label{eq:transp7} \\ \nonumber
    \end{align}
    Onde LB e UB são, respectivamente, limitante inferior
    e limitante superior para ciclos ímpares (facilmente
    calculados a partir de $\pi$ e $\sigma$).
  \end{beamerboxesrounded}
}

%%% Reversoes

\frame{
  \frametitle{Modelo - Reversão}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Agora vamos apresentar as variáveis e restrições que são
    referentes à operação de reversão.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $r_{abk}$}
    Indicam quando a $k$-ésima operação de reversão afeta o blocos
    $\pi[a \cdots b]$ de $\pi$, para todo $1 \le a < b \le n$ e todo $
    1 \le k < n$.
    \[
    r_{abk} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(a,b)$ \\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $r_{k}$}
    É usada para decidir se a $k$-ésima operação de reversão modificou
    a permutação, para todo $ 1 \le k < n$.
    \[
    r_{k} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(x,y)$ e $\rho_{k} \rho_{k-1} \cdots 
        \rho_{1} \pi \neq \rho_{k-1} \cdots \rho_{1} \pi$\\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Reversão - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As restrições \ref{eq:rev1} e \ref{eq:rev2} são necessárias
    para identificar as reversões que fazem parte da solução.
    \begin{align}
      &r_{k} \le r_{k-1}, \text{para todo $1 \le k <
        n$}. \label{eq:rev1} \\
      \sum_{a=1}^{n-1}\sum_{b=a+1}^{n} &r_{abk} \le r_{k} , \text{para
        todo $1 \le k < n$}. \label{eq:rev2}
    \end{align}
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As próximas restrições lidam com as modificações na permutação
    causada pela reversão a cada passo da execução. A análise será
    dividida em dois casos onde, para cada caso, analisamos cada
    posição $i$ da permutação para verificar seu valor após a operação
    de reversão $\rho(a,b)$ ser completada.
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Reversão - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    1. $i < a$ ou $i > b$:
    \begin{align}
      \sum_{a=i+1}^{n-1}\sum_{b=a+1}^{n} r_{abk} +
      \sum_{a=1}^{n-1}\sum_{b=a+1}^{i-1} r_{abk} +
      (1 - r_{k}) + B_{i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{para todo $1 \le i, j \le n$ e todo $1 \le k < n$}.
      \label{eq:rev3}
    \end{align}
    2. $a \le i \le b$:
    \begin{align}
      r_{abk} + B_{b+a-i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{$1 \le a < b \le n, a \le i \le b, 1 \le j
        \le n, 1 \le k < n$}.
      \label{eq:rev4}
    \end{align}
  \end{beamerboxesrounded}
}

%%% Reversoes e Transposicoes

\frame{
  \frametitle{Modelo - Reversão e Transposição}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Para formular o problema da distância de reversão e transposição
    vamos utilizar todas as variáveis definidas anteriormente,
    adicionando um novo conjunto de variáveis ao problema.
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $z_{k}$}
    É usada para decidir se a $k$-ésima operação de reversão ou
    transposição modificou a permutação $\pi$. Portanto para todo $1
    \le k < n$:
    \[
    z_{k} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(x,y)$ ou $\rho_{k} = \rho(x,y,z)$ e 
        $\rho_{k} \rho_{k-1} \cdots 
        \rho_{1} \pi \neq \rho_{k-1} \cdots \rho_{1} \pi$\\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Reversão e Transposição - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Usaremos todas as restrições definidas anteriormente, com excessão
    das restrições \ref{eq:transp1}, \ref{eq:rev1}, \ref{eq:transp6} e
    \ref{eq:transp7} que serão substituidas pelas restrições
    \ref{eq:rt1} e \ref{eq:rt2}.
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{Restrições}
    A restrição \ref{eq:rt1} garante que se não ocorreu operações em
    um passo da execução então não ocorrerá nenhuma operação nos
    passos seguintes. A restrição \ref{eq:rt2} garante que no máximo
    uma operação é executada a cada passo.
    \begin{align}
      &z_{k} \le z_{k-1}, \text{para todo $1 \le k <
        n$}. \label{eq:rt1} \\
      &r_{k} + t_{k} = z_{k} , \text{para
        todo $1 \le k < n$}. \label{eq:rt2}
    \end{align}
  \end{beamerboxesrounded}
}

%%% Funcao objetivo
\frame{
  \frametitle{Modelo - Função Objetivo}
  \begin{beamerboxesrounded}[center,shadow=true]{Funções Objetivos}
    \begin{align}
      \omega_{t} &= \min \sum_{k=1}^{n-1} t_{k}, \text{Transposição}. 
      \label{eq:fotra} \\
      \omega_{r} &= \min \sum_{k=1}^{n-1} r_{k}, \text{Reversão}.
      \label{eq:forev} \\
      \omega_{rt} &= \min \sum_{k=1}^{n-1} z_{k}, \text{Reversão e
        Transposição}.
      \label{eq:fort}
    \end{align}
  \end{beamerboxesrounded}
}

\normalsize

\subsection{Metodologias}
\frame{
  \frametitle{Metodologias}
  Explicação dos métodos que irão ser usados. (1-4 slides) \\
  Explicar que podemos utilizar a Relaxação Lagrangeana ou criar um
  novo modelo e aplicar técnicas como branch-and-cut ou geração de
  colunas.
}

\section{Programação Lógica por Restrições}

\frame{
  \frametitle{Programação Lógica por Restrições}
  \begin{itemize}
  \item{Apresentado por Dias e Dias (2009).}
  \item{Modelo específico para o eventos de transposição.}
  \item{Duas formulações. Uma baseada na teoria do Problema de
      Satisfação de Restrições (CSP) e a outra baseada na teoria do
      Problema de Otimização com Restrições (COP).}
  \item{Modelo simples. Não está utilizando algumas propriedades do
      problema que podem melhorar a formulação.}
  \end{itemize}
}

\scriptsize

\subsection{Formulações}

%%% formulacao csp
\frame{
  \frametitle{Formulação CSP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Primeiramente vamos apresentar a formulação baseada na teoria CSP.
    Uma permutação $\pi$ é uma lista de elementos
    ($\pi_{1},\pi_{2},\ldots,\pi_{n}$) onde $\pi_{i} \in \mathbb{N}$,
    $0 < \pi \le n$ e $\pi_{i} \neq \pi_{j}$ para $i \neq j$.  Uma
    transposição $\rho(i,j,k)$, $0 < i < j < k \le n$, tem o efeito de
    separar a lista em quatro sub-listas $C_{1}C_{2}C_{3}C_{4}$ onde
    $C_{1} = (\pi_{1},\ldots,\pi_{i-1}), C_{2} =
    (\pi_{i},\ldots,\pi_{j-1}), C_{3} = (\pi_{j},\ldots,\pi_{k-1}) e
    C_{4} = (\pi_{k},\ldots,\pi_{n})$, e juntando elas da forma
    $\pi\rho = C_{1}C_{3}C_{2}C_{4}$.
  \end{beamerboxesrounded}
  \begin{columns}[c]
    \begin{column}{5cm}
      \begin{beamerboxesrounded}[center,shadow=true]{permutation/2}
        %% \begin{algorithm}[H]
        \begin{align}
          per&mutation(\pi, N) :- \nonumber\\
          &length(\pi, N), \nonumber\\
          &\pi :: [1 .. N], \nonumber\\
          &all\_different(\pi). \nonumber
        \end{align}
        %% \end{algorithm}
      \end{beamerboxesrounded}
    \end{column}
    \begin{column}{5cm}
      \begin{beamerboxesrounded}[center,shadow=true]{transposition/5}
        %% \begin{algorithm}[H]
        \begin{align}
          tra&nsposition(\pi, \sigma, I, J, K) :- \nonumber\\
          &permutation(\pi, N), \nonumber\\
          &permutation(\sigma, N), \nonumber\\
          &1 \le I < J < K \le N, \nonumber\\
          &split(\pi, I, J, K, C_{1}, C_{2}, C_{3}, C_{4}), \nonumber\\
          &\sigma = C_{1}, C_{3}, C_{2}, C_{4}. \nonumber
        \end{align}
        %% \end{algorithm}
      \end{beamerboxesrounded}
    \end{column}
  \end{columns}
}

\frame{
  \frametitle{Formulação CSP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    A formulação baseada na teoria CSP possui um número variável
    desconhecido, pois precisamos do valor da distância $d(\pi)$ para
    atribuir as constantes e as variáveis que representam a
    permutação. Para isso escolhemos um valor candidato para a
    distância $T \in [L .. U]$, onde $L$ é um valor conhecido para o
    limitante inferior e $U$ é um valor conhecido para o limitante
    superior.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{distance/3}
    %% \begin{algorithm}[H]
    \begin{align}
      dis&tance(\iota, 0, \_Model). \nonumber\\
      dis&tance(\pi, T, Model) :- \nonumber\\
      &bound(\pi, Model, LowerBound, UpperBound), \nonumber\\
      &T :: [LowerBound .. UpperBound], \nonumber\\
      &indomain(T), \nonumber \\
      &transposition(\pi, \sigma, \_I, \_J, \_K), \nonumber \\
      &distance(\sigma, T-1, Model). \nonumber
    \end{align}
    %% \end{algorithm}
  \end{beamerboxesrounded}
}

%%% formulacao COP
\frame{
  \frametitle{Formulação COP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    A formulação baseada na teoria COP, precisa de um valor para o
    limitante superior e algumas modificações nos predicados definidos
    anteriormente. Usamos as variáveis binárias $B$ para indicar
    quando uma transposição modificou a permutação.\\
    O predicado $transposition\_cop/6$ é criado para suprir a
    necessidade de indicar quando a transposição modificou ou não a
    permutação. Se $(i,j,k) = (0,0,0)$ então $\pi\rho = \pi$. Caso
    contrário, a permutação foi modificada e então o valor da variável
    $B$ para este caso é $1$.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{transposition\_cop/6}
    %% \begin{algorithm}[H]
    \begin{align}
      tra&nsposition\_cop(\iota, \iota, 0, 0, 0, 0). \nonumber\\
      tra&nsposition\_cop(\pi, \sigma, I, J, K, 1) :- 
      transposition(\pi, \sigma, I, J, K).\nonumber
    \end{align}
    %% \end{algorithm}
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Formulação COP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    O predicado $distance\_cop/3$ atribui valores as variáveis
    binárias $B$ utilizando o limitante superior e as restrições
    fazendo a permutação $\pi_{k} = \pi_{k-1}\rho_{k}$.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{distance\_cop/3}
    %% \begin{algorithm}[H]
    \begin{align}
      dis&tance\_cop(\pi, N, Model) :- \nonumber\\
      &bound(\pi, Model, LowerBound, UpperBound), \nonumber\\
      &length(B, UpperBound), \nonumber\\
      &upperbound\_constraint(\pi, B, UpperBound), \nonumber \\
      &sum(B, Cost), \nonumber \\
      &Cost \ge LowerBound, \nonumber \\
      &minimize(Cost, N). \nonumber
    \end{align}
    %% \end{algorithm}
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Formulação COP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    O predicado $upperbound\_constraint/3$ recupera os valores de $B$
    para cada transposição $\rho_{k}$ e insere os efeitos de
    $\rho_{k}$ sobre a seqüência de permutações.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{upperbound\_constraint/3}
    %% \begin{algorithm}[H]
    \begin{align}
      upp&erbound\_constraint(\iota, [~], \_UpperBound). \nonumber\\
      upp&erbound\_constraint(\pi, [B|Bs], UpperBound) :- \nonumber\\
      &transposition\_cop(\pi, \sigma, \_I, \_J, \_K, B), \nonumber\\
      &bound(\pi, Model, LowerBound, \_UpperBound), \nonumber\\
      &UpperBound \ge LowerBound, \nonumber\\
      &upperbound\_constraint(\pi, Bs, UpperBound-1). \nonumber
    \end{align}
    %% \end{algorithm}
  \end{beamerboxesrounded}
}

\normalsize

\subsection{Metodologias}
\frame{
  \frametitle{Metodologias}
  Explicação dos métodos que irão ser usados. (1-4 slides) \\
  Aproveitar o fato do modelo não estar usando informações que
  poderiam melhorar os resultados. Por exemplo, o grafo de cíclos da
  permutação que pode auxiliar na escolha de qual conjunto de
  transposições vai ser ramificado primeiro.
}

\section{Objetivos}

\frame{
  \frametitle{Objetivos}
  \begin{itemize}
  \item{Procurar um método para melhorar o tempo de execução do modelo
      de programação linear inteira apresentado por Dias e de Souza
      (2007), desta forma tornando o uso desta abordagem viável para o
      uso na prática.}
  \item{Aprimorar o modelo de programação por restrições apresentado
      por Dias e Dias (2009).}
  \end{itemize}
}

\section{Cronograma}

\frame{
  \frametitle{Cronograma}
  \begin{itemize}
  \item{1. Cumprimento das disciplinas obrigatórias do programa de mestrado.}
  \item{2. Revisão Bibliográfica dos artigos clássicos sobre rearranjo
      de genomas.}
  \item{3. Escrita do projeto de mestrado e exame de qualificação.}
  \item{4. Estudo e desenvolvimento sobre o modelo de programação
      linear inteira para o problema de rearranjo de genomas.}
  \item{5. Estudo e desenvolvimento sobre o modelo de programação
      por restrições para o problema de rearranjo de genomas.}
  \end{itemize}
}

\frame{
  \frametitle{Cronograma}
  \begin{itemize}
  \item{6. Testes dos modelos desenvolvidos.}
  \item{7. Escrita da dissertação. A escrita começará a ser feita a
      partir dos primeiros resultados.}
  \item{8. Revisão final do texto da dissertação.}
  \item{9. Defesa da dissertação.}
  \end{itemize}
}

\frame{
  \frametitle{Cronograma}
  \begin{table}[ht]
    \begin{center}
      \small
      \begin{tabular}{||c|| c|c|c|c|c|c|c|c|c|c || c|c ||}
        \hline \hline
        
        %% Anos
        Ativ. & \multicolumn{10}{c||}{2009} & \multicolumn{2}{c||}{2010} \\
        \cline{02-13}
        
        %% Meses
        & 03 & 04 & 05 & 06 & 07 & 08 & 09 & 10 & 11 & 12 & 01 & 02 \\
        \hline
        \hline          %$\surd$   0   0   0   0   0   0   0   1   1   1   0   0
        % 3   4   5   6   7   8   9   0   1   2   1   2
        1                        & x & x & x & x & x & x & x & x & x & x &   &   \\ \hline
        2                        & x & x & x & x & x & x & x & x & x & x &   &   \\ \hline
        3                        &   &   &   &   & x & x & x &   &   &   &   &   \\ \hline
        4                        &   &   &   &   &   &   &   &   &   &   & x & x \\ \hline
        \hline
      \end{tabular}
      \caption{Cronograma de atividades (mar/2009 - fev/2010)}
      \label{tab:cron1}
    \end{center}
  \end{table}
}

\frame{
  \frametitle{Cronograma}
  \begin{table}[ht]
    \begin{center}
      \small
      \begin{tabular}{||c|| c|c|c|c|c|c|c|c|c|c || c|c ||}
        \hline \hline
        
        %% Anos
        Ativ. & \multicolumn{10}{c||}{2010} & \multicolumn{2}{c||}{2011} \\
        \cline{02-13}
        
        %% Meses
        & 03 & 04 & 05 & 06 & 07 & 08 & 09 & 10 & 11 & 12 & 01 & 02 \\
        \hline
        \hline          %$\surd$   0   0   0   0   0   0   0   1   1   1   0   0
        % 3   4   5   6   7   8   9   0   1   2   1   2
        4                        & x & x & x & x &   &   &   &   &   &   &   &   \\ \hline
        5                        &   &   &   &   & x & x & x & x & x & x &   &   \\ \hline
        6                        &   & x & x & x &   &   &   & x & x & x &   &   \\ \hline
        7                        &   & x & x & x &   &   &   & x & x & x &   &   \\ \hline
        8                        &   &   &   &   &   &   &   &   &   &   & x &   \\ \hline
        9                        &   &   &   &   &   &   &   &   &   &   &   & x \\ \hline
        \hline
      \end{tabular}
      \caption{Cronograma de atividades (mar/2010 - fev/2011)}
      \label{tab:cron2}
    \end{center}
  \end{table}
}

\end{document}
