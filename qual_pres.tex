\documentclass{beamer}

\mode<presentation>
{
%  \usetheme{Berkeley}
  \usetheme{Warsaw}
  \setbeamercovered{transparent}
}

\usepackage[brazil]{babel}
\usepackage[latin1]{inputenc}

\usepackage{graphicx}
\usepackage{setspace}
\usepackage{graphics}
\usepackage[portugues, 
	    resetcount, 
	    noline]{algorithm2e}
\usepackage{amsmath}
\usepackage{amsfonts}

\include{include/abaco}

\title[PLI e PR para Problemas de Rearranjo de Genomas]{Programação
  Linear Inteira e Programação Lógica por Restrições para Problemas de
  Rearranjo de Genomas} 

\author{Victor de Abreu Iizuka}

\institute[Universidade Estadual de Campinas] {
  \text{Orientador: Zanoni Dias} \\
  \textbf{Instituto de Computação - UNICAMP}\\
  \parbox{1in}{\center{\ABACO{2}{0}{0}{9}{0.7}}}
}

\date{}

\begin{document}

\frame{\titlepage}

\frame{\tableofcontents}

\section{Introdução}

\frame{ 
  \frametitle{Introdução} 
  Esta seção irá introduzir os problemas de rearranjos de genomas,
  motivações do problema. (2-6 slides) 
}

\section{Ordenação por Reversões}

\frame{
  \frametitle{Ordenação por Reversões}
  Explicação relacionando trabalhos já feitos. (2-4 slides)
}

\section{Ordenação por Transposições}

\frame{
  \frametitle{Ordenação por Transposições}
  Explicação relacionando trabalhos já feitos. (2-4 slides)
}

\section{Programação Linear Inteira}

\frame{
  \frametitle{Programação Linear Inteira}
  \begin{itemize}
  \item{Apresentado por Dias e de Souza,2007.}
  \item{Modelo para o problema da distância com tamanho polinomial.}
  \item{Modelo específico para os eventos de reversão, transposição ou
      reversão e transposição simultaneamente.}
  \item{Possui um tempo de execução muito grande. O programa retornava
      \textit{timeout} para instâncias de tamanho
      10 (tempo limite de 10 horas).}
  \item{Inviável na prática.}
  \end{itemize}
}

\scriptsize

\subsection{Modelo}

%%% Variaveis e restricoes comuns

\frame{
  \frametitle{Modelo}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Primeiramente vamos apresentar as variáveis e restrições que são
    comuns para todos modelos. A idéia é assegurar que só estamos
    tratando com permutações válidas.
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis $B_{ijk}$}
    Indicam se a $i$-ésima posição de $\pi$
    possui o valor $j$ depois da $k$-ésima operação ter sido executada,
    para todo $1 \le i, j \le n$ e todo $ 0 \le k < n$.
    \[
    B_{ijk} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\pi[i]$ = $j$ depois da $k$-ésima operação \\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Restrições Comuns}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As restrições \ref{eq:corr1} e \ref{eq:corr2} garantem que a
    permutação inicial e a final são corretas.
    \begin{equation}
      \label{eq:corr1}
      B_{i,\pi[i],0} = 1, \text{para todo $1 \le i \le n$}.
    \end{equation}
    \begin{equation}
      \label{eq:corr2}
      B_{i,\sigma[i],n-1} = 1, \text{para todo $1 \le i \le n$}.
    \end{equation}
    A restrição \ref{eq:posval} garante que cada posição de uma
    permutação possui exatamente um valor associado a ela. Já a
    restrição \ref{eq:valpos} garante que todo valor esteja associado
    a uma posição de cada permutação.
    \begin{equation}
      \label{eq:posval}
      \sum_{j=1}^{n} B_{ijk} = 1, \text{para todo $1 \le i \le n$, 
        $0 \le k < n$}.
    \end{equation}
    \begin{equation}
      \label{eq:valpos}
      \sum_{i=1}^{n} B_{ijk} = 1, \text{para todo $1 \le i \le n$, 
        $0 \le k < n$}.
    \end{equation}
  \end{beamerboxesrounded}
}

%%% Transposicoes

\frame{
  \frametitle{Modelo - Transposição}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Agora vamos apresentar as variáveis e restrições que são
    referentes à operação de transposição.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $t_{abck}$}
    Indicam quando a $k$-ésima operação de transposição realiza a
    troca de lugares dos blocos $\pi[a \cdots b - 1]$ e $\pi[b \cdots
    c - 1]$ de $\pi$, para todo $1 \le a < b < c \le n + 1$ e todo $ 1
    \le k < n$.
    \[
    t_{abck} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(a,b,c)$ \\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $t_{k}$}
    É usada para decidir se a $k$-ésima operação de transposição
    modificou a permutação, para todo $ 1 \le k < n$.
    \[
    t_{k} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(x,y,z)$ e $\rho_{k} \rho_{k-1} \cdots 
        \rho_{1} \pi \neq \rho_{k-1} \cdots \rho_{1} \pi$\\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Transposição - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As restrições \ref{eq:transp1} e \ref{eq:transp2} são necessárias
    para identificar as transposições que fazem parte da solução.
    \begin{align}
      &t_{k} \le t_{k-1}, \text{para todo $1 \le k <
        n$}. \label{eq:transp1} \\
      \sum_{a=1}^{n-1}\sum_{b=a+1}^{n}\sum_{c=b+1}^{n+1} &t_{abck} \le
      t_{k} , \text{para todo $1 \le k < n$}. \label{eq:transp2}
    \end{align}
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As próximas restrições refletem a modificações na permutação
    causada pela transposição a cada passo da execução. A análise será
    dividida em três casos onde, para cada caso, analisamos cada
    posição $i$ da permutação para verificar seu valor após a operação
    de transposição $\rho(a,b,c)$ ser completada.
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Transposição - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    1. $i < a$ ou $i \ge c$:
    \begin{align}
      \sum_{a=i+1}^{n-1}\sum_{b=a+1}^{n}\sum_{c=b+1}^{n+1} t_{abck} +
      \sum_{a=1}^{n-1}\sum_{b=a+1}^{n}\sum_{c=b+1}^{i} t_{abck} +
      (1 - t_{k}) + B_{i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{para todo $1 \le i, j \le n$ e todo $1 \le k < n$}.
      \label{eq:transp3}
    \end{align}
    2. $a \le i < a + c -b$:
    \begin{align}
      t_{abck} + B_{b-a+i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{$1 \le a < b < c \le n + 1, a \le i < a + c -b, 1 \le j
        \le n, 1 \le k < n$}.
      \label{eq:transp4}
    \end{align}
    3. $a + c - b \le i < c$:
    \begin{align}
      t_{abck} + B_{b-c+i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{$1 \le a < b < c \le n + 1, a + c - b \le i < c, 1 \le j
        \le n, 1 \le k < n$}.
      \label{eq:transp5}
    \end{align}
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Transposição - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Usando o limitante superior e o inferior definido por Bafna e
    Pevzner,1998, obtemos as seguintes restrições. \\
    \begin{align}
      t_{k} * n + k - 1 &\ge LB(\pi,\sigma), \text{para todo $1 \le k
        \le n$}. \label{eq:transp6} \\
      t_{k} * k &\le UB(\pi,\sigma), \text{para todo $1 \le k \le
        n$}. \label{eq:transp7} \\ \nonumber
    \end{align}
    Onde LB e UB são, respectivamente, limitante inferior
    e limitante superior para ciclos ímpares (facilmente
    calculados a partir de $\pi$ e $\sigma$).
  \end{beamerboxesrounded}
}

%%% Reversoes

\frame{
  \frametitle{Modelo - Reversão}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Agora vamos apresentar as variáveis e restrições que são
    referentes à operação de reversão.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $r_{abk}$}
    Indicam quando a $k$-ésima operação de reversão afeta o blocos
    $\pi[a \cdots b]$ de $\pi$, para todo $1 \le a < b \le n$ e todo $
    1 \le k < n$.
    \[
    r_{abk} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(a,b)$ \\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $r_{k}$}
    É usada para decidir se a $k$-ésima operação de reversão modificou
    a permutação, para todo $ 1 \le k < n$.
    \[
    r_{k} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(x,y)$ e $\rho_{k} \rho_{k-1} \cdots 
        \rho_{1} \pi \neq \rho_{k-1} \cdots \rho_{1} \pi$\\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Reversão - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As restrições \ref{eq:rev1} e \ref{eq:rev2} são necessárias
    para identificar as reversões que fazem parte da solução.
    \begin{align}
      &r_{k} \le r_{k-1}, \text{para todo $1 \le k <
        n$}. \label{eq:rev1} \\
      \sum_{a=1}^{n-1}\sum_{b=a+1}^{n} &r_{abk} \le r_{k} , \text{para
        todo $1 \le k < n$}. \label{eq:rev2}
    \end{align}
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    As próximas restrições lidam com as modificações na permutação
    causada pela reversão a cada passo da execução. A análise será
    dividida em dois casos onde, para cada caso, analisamos cada
    posição $i$ da permutação para verificar seu valor após a operação
    de reversão $\rho(a,b)$ ser completada.
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Reversão - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    1. $i < a$ ou $i > b$:
    \begin{align}
      \sum_{a=i+1}^{n-1}\sum_{b=a+1}^{n} r_{abk} +
      \sum_{a=1}^{n-1}\sum_{b=a+1}^{i-1} r_{abk} +
      (1 - r_{k}) + B_{i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{para todo $1 \le i, j \le n$ e todo $1 \le k < n$}.
      \label{eq:rev3}
    \end{align}
    2. $a \le i \le b$:
    \begin{align}
      r_{abk} + B_{b+a-i,j,k-1} - B_{ijk} \le 1, \nonumber \\
      \text{$1 \le a < b \le n, a \le i \le b, 1 \le j
        \le n, 1 \le k < n$}.
      \label{eq:rev4}
    \end{align}
  \end{beamerboxesrounded}
}

%%% Reversoes e Transposicoes

\frame{
  \frametitle{Modelo - Reversão e Transposição}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Para formular o problema da distância de reversão e transposição
    vamos utilizar todas as variáveis definidas anteriormente,
    adicionando um novo conjunto de variáveis ao problema.
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{Variáveis Binárias
      $z_{k}$}
    É usada para decidir se a $k$-ésima operação de reversão ou
    transposição modificou a permutação $\pi$. Portanto para todo $1
    \le k < n$:
    \[
    z_{k} = \left \{ 
      \begin{tabular}{ll} 
        1, & se $\rho_{k} = \rho(x,y)$ ou $\rho_{k} = \rho(x,y,z)$ e 
        $\rho_{k} \rho_{k-1} \cdots 
        \rho_{1} \pi \neq \rho_{k-1} \cdots \rho_{1} \pi$\\
        0, & caso contrário
      \end{tabular} \right .
    \]
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Modelo - Reversão e Transposição - Restrições}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Usaremos todas as restrições definidas anteriormente, com excessão
    das restrições \ref{eq:transp1}, \ref{eq:rev1}, \ref{eq:transp6} e
    \ref{eq:transp7} que serão substituidas pelas restrições
    \ref{eq:rt1} e \ref{eq:rt2}.
  \end{beamerboxesrounded}
  \vspace{1cm}
  \begin{beamerboxesrounded}[center,shadow=true]{Restrições}
    A restrição \ref{eq:rt1} garante que se não ocorreu operações em
    um passo da execução então não ocorrerá nenhuma operação nos
    passos seguintes. A restrição \ref{eq:rt2} garante que no máximo
    uma operação é executada a cada passo.
    \begin{align}
      &z_{k} \le z_{k-1}, \text{para todo $1 \le k <
        n$}. \label{eq:rt1} \\
      &r_{k} + t_{k} = z_{k} , \text{para
        todo $1 \le k < n$}. \label{eq:rt2}
    \end{align}
  \end{beamerboxesrounded}
}

%%% Funcao objetivo
\frame{
  \frametitle{Modelo - Função Objetivo}
  \begin{beamerboxesrounded}[center,shadow=true]{Funções Objetivos}
    \begin{align}
      \omega_{t} &= \min \sum_{k=1}^{n-1} t_{k}, \text{Transposição}. 
      \label{eq:fotra} \\
      \omega_{r} &= \min \sum_{k=1}^{n-1} r_{k}, \text{Reversão}.
      \label{eq:forev} \\
      \omega_{rt} &= \min \sum_{k=1}^{n-1} z_{k}, \text{Reversão e
        Transposição}.
      \label{eq:fort}
    \end{align}
  \end{beamerboxesrounded}
}

\normalsize

\subsection{Metodologias}
\frame{
  \frametitle{Metodologias}
  Explicação dos métodos que irão ser usados. (1-4 slides)
}

\section{Programação Lógica por Restrições}

\frame{
  \frametitle{Programação Lógica por Restrições}
  \begin{itemize}
  \item{Apresentado por Dias e Dias,2009.}
  \item{Modelo específico para o eventos de transposição.}
  \item{Duas formulações. Uma baseada na teoria do Problema de
      Satisfação de Restrições (CSP) e a outra baseada na teoria do
      Problema de Otimização com Restrições (COP).}
  \item{Modelo simples. Não está utilizando algumas propriedades do
      problema que podem melhorar a formulação.}
  \end{itemize}
}

\scriptsize

\subsection{Formulações}

%%% formulacao csp
\frame{
  \frametitle{Formulação CSP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    Primeiramente vamos apresentar a formulação baseada na teoria CSP.
    Uma permutação $\pi$ é uma lista de elementos
    ($\pi_{1},\pi_{2},\ldots,\pi_{n}$) onde $\pi_{i} \in \mathbb{N}$,
    $0 < \pi \le n$ e $\pi_{i} \neq \pi_{j}$ para $i \neq j$.  Uma
    transposição $\rho(i,j,k)$, $0 < i < j < k \le n$, tem o efeito de
    separar a lista em quatro sub-listas $C_{1}C_{2}C_{3}C_{4}$ onde
    $C_{1} = (\pi_{1},\ldots,\pi_{i-1}), C_{2} =
    (\pi_{i},\ldots,\pi_{j-1}), C_{3} = (\pi_{j},\ldots,\pi_{k-1}) e
    C_{4} = (\pi_{k},\ldots,\pi_{n})$, e juntando elas da forma
    $\pi\rho = C_{1}C_{3}C_{2}C_{4}$.
  \end{beamerboxesrounded}
  \begin{columns}[c]
    \begin{column}{5cm}
      \begin{beamerboxesrounded}[center,shadow=true]{permutation/2}
        %% \begin{algorithm}[H]
        \begin{align}
          per&mutation(\pi, N) :- \nonumber\\
          &length(\pi, N), \nonumber\\
          &\pi :: [1 .. N], \nonumber\\
          &all\_different(\pi). \nonumber
        \end{align}
        %% \end{algorithm}
      \end{beamerboxesrounded}
    \end{column}
    \begin{column}{5cm}
      \begin{beamerboxesrounded}[center,shadow=true]{transposition/5}
        %% \begin{algorithm}[H]
        \begin{align}
          tra&nsposition(\pi, \sigma, I, J, K) :- \nonumber\\
          &permutation(\pi, N), \nonumber\\
          &permutation(\sigma, N), \nonumber\\
          &1 \le I < J < K \le N, \nonumber\\
          &split(\pi, I, J, K, C_{1}, C_{2}, C_{3}, C_{4}), \nonumber\\
          &\sigma = C_{1}, C_{3}, C_{2}, C_{4}. \nonumber
        \end{align}
        %% \end{algorithm}
      \end{beamerboxesrounded}
    \end{column}
  \end{columns}
}

\frame{
  \frametitle{Formulação CSP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    A formulação baseada na teoria CSP possui um número variável
    desconhecido, pois precisamos do valor da distância $d(\pi)$ para
    atribuir as constantes e as variáveis que representam a
    permutação. Para isso escolhemos um valor candidato para a
    distância $T \in [L .. U]$, onde $L$ é um valor conhecido para o
    limitante inferior e $U$ é um valor conhecido para o limitante
    superior.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{distance/3}
    %% \begin{algorithm}[H]
    \begin{align}
      dis&tance(\iota, 0, \_Model). \nonumber\\
      dis&tance(\pi, T, Model) :- \nonumber\\
      &bound(\pi, Model, LowerBound, UpperBound), \nonumber\\
      &T :: [LowerBound .. UpperBound], \nonumber\\
      &indomain(T), \nonumber \\
      &transposition(\pi, \sigma, \_I, \_J, \_K), \nonumber \\
      &distance(\sigma, T-1, Model). \nonumber
    \end{align}
    %% \end{algorithm}
  \end{beamerboxesrounded}
}

%%% formulacao COP
\frame{
  \frametitle{Formulação COP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    A formulação baseada na teoria COP, precisa de um valor para o
    limitante superior e algumas modificações nos predicados definidos
    anteriormente. Usamos as variáveis binárias $B$ para indicar
    quando uma transposição modificou a permutação.\\
    O predicado $transposition\_cop/6$ é criado para suprir a
    necessidade de indicar quando a transposição modificou ou não a
    permutação. Se $(i,j,k) = (0,0,0)$ então $\pi\rho = \pi$. Caso
    contrário, a permutação foi modificada e então o valor da variável
    $B$ para este caso é $1$.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{transposition\_cop/6}
    %% \begin{algorithm}[H]
    \begin{align}
      tra&nsposition\_cop(\iota, \iota, 0, 0, 0, 0). \nonumber\\
      tra&nsposition\_cop(\pi, \sigma, I, J, K, 1) :- 
      transposition(\pi, \sigma, I, J, K).\nonumber\\
    \end{align}
    %% \end{algorithm}
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Formulação COP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    O predicado $distance\_cop/3$ atribui valores as variáveis
    binárias $B$ utilizando o limitante superior e as restrições
    fazendo a permutação $\pi_{k} = \pi_{k-1}\rho_{k}$.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{distance\_cop/3}
    %% \begin{algorithm}[H]
    \begin{align}
      dis&tance\_cop(\pi, N, Model) :- \nonumber\\
      &bound(\pi, Model, LowerBound, UpperBound), \nonumber\\
      &length(B, UpperBound), \nonumber\\
      &upperbound\_constraint(\pi, B, UpperBound), \nonumber \\
      &sum(B, Cost), \nonumber \\
      &Cost \ge LowerBound, \nonumber \\
      &minimize(Cost, N). \nonumber
    \end{align}
    %% \end{algorithm}
  \end{beamerboxesrounded}
}

\frame{
  \frametitle{Formulação COP}
  \begin{beamerboxesrounded}[center,shadow=true]{}
    O predicado $upperbound\_constraint/3$ recupera os valores de $B$
    para cada transposição $\rho_{k}$ e insere os efeitos de
    $\rho_{k}$ sobre a sequência de permutações.
  \end{beamerboxesrounded}
  \begin{beamerboxesrounded}[center,shadow=true]{upperbound\_constraint/3}
    %% \begin{algorithm}[H]
    \begin{align}
      upp&erbound\_constraint(\iota, [~], \_UpperBound). \nonumber\\
      upp&erbound\_constraint(\pi, [B|Bs], UpperBound) :- \nonumber\\
      &transposition\_cop(\pi, \sigma, \_I, \_J, \_K, B), \nonumber\\
      &bound(\pi, Model, LowerBound, \_UpperBound), \nonumber\\
      &UpperBound \ge LowerBound, \nonumber\\
      &upperbound\_constraint(\pi, Bs, UpperBound-1). \nonumber \\
    \end{align}
    %% \end{algorithm}
  \end{beamerboxesrounded}
}

\subsection{Metodologias}
\frame{
  \frametitle{Metodologias}
  Explicação dos métodos que irão ser usados. (1-4 slides)
}

\section{Objetivos}

\frame{
  \frametitle{Objetivos}
  Objetivos do projeto
}

\section{Cronograma}

\frame{
  \frametitle{Cronograma}
  Cronograma com as atividades a serem desenvolvidas (1-3 slides)
}


\end{document}
